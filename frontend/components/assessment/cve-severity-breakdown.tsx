"use client"

import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend } from 'recharts';

interface CVESeverityBreakdownProps {
  severityBreakdown: {
    critical: number;
    high: number;
    medium: number;
    low: number;
  };
}

export function CVESeverityBreakdown({ severityBreakdown }: CVESeverityBreakdownProps) {
  const data = [
    { name: 'Critical', value: severityBreakdown.critical, color: '#ef4444' },
    { name: 'High', value: severityBreakdown.high, color: '#f97316' },
    { name: 'Medium', value: severityBreakdown.medium, color: '#f59e0b' },
    { name: 'Low', value: severityBreakdown.low, color: '#3b82f6' },
  ].filter(item => item.value > 0);

  const total = Object.values(severityBreakdown).reduce((sum, val) => sum + val, 0);

  return (
    <Card>
      <CardHeader>
        <CardTitle>Severity Distribution</CardTitle>
        <CardDescription>Breakdown by CVE severity level</CardDescription>
      </CardHeader>
      <CardContent>
        <div className="flex flex-col md:flex-row items-center gap-8">
          {/* Pie Chart */}
          <div className="flex-1 w-full">
            <ResponsiveContainer width="100%" height={250}>
              <PieChart>
                <Pie
                  data={data}
                  cx="50%"
                  cy="50%"
                  labelLine={false}
                  label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}
                  outerRadius={80}
                  fill="#8884d8"
                  dataKey="value"
                >
                  {data.map((entry, index) => (
                    <Cell key={`cell-${index}`} fill={entry.color} />
                  ))}
                </Pie>
                <Tooltip 
                  contentStyle={{ 
                    backgroundColor: 'hsl(var(--popover))', 
                    border: '1px solid hsl(var(--border))',
                    borderRadius: '8px'
                  }}
                />
              </PieChart>
            </ResponsiveContainer>
          </div>

          {/* Stats Grid */}
          <div className="flex-1 grid grid-cols-2 gap-4 w-full">
            <div className="text-center p-4 bg-red-500/10 border border-red-500/20 rounded-lg">
              <div className="text-3xl font-bold text-red-500">{severityBreakdown.critical}</div>
              <div className="text-sm text-muted-foreground">Critical</div>
            </div>
            <div className="text-center p-4 bg-orange-500/10 border border-orange-500/20 rounded-lg">
              <div className="text-3xl font-bold text-orange-500">{severityBreakdown.high}</div>
              <div className="text-sm text-muted-foreground">High</div>
            </div>
            <div className="text-center p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg">
              <div className="text-3xl font-bold text-yellow-500">{severityBreakdown.medium}</div>
              <div className="text-sm text-muted-foreground">Medium</div>
            </div>
            <div className="text-center p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg">
              <div className="text-3xl font-bold text-blue-500">{severityBreakdown.low}</div>
              <div className="text-sm text-muted-foreground">Low</div>
            </div>
          </div>
        </div>
      </CardContent>
    </Card>
  );
}
